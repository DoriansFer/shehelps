<!DOCTYPE html>
<html lang="en" th:replace="~{base :: layout (~{:: main})}" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<main>
    <h2>
        ABRIR CHAMADO AQUI
    </h2>
    <p>
        Um chamado
        técnico é quando um usuário solicita um atendimento e um técnico
        assume esse chamado, começando o atendimento e modificando seu
        status. Cada chamado inclui informações como usuário, setor, descrição,
        prioridade e data de início.
    </p>
    <form action="/criar-chamado" method="post">
        <label for="descricao">Descrição:</label><br>
        <textarea id="descricao" name="descricao" rows="4" cols="50"></textarea><br>

        <label for="prioridade">Prioridade:</label><br>
        <select id="prioridade" name="prioridade">
            <option value="baixa">Baixa</option>
            <option value="média">Média</option>
            <option value="alta">Alta</option>
        </select><br>

        <label for="setorDeDirecionamento">Setor de Direcionamento:</label><br>
        <select id="setorDeDirecionamento" name="setorDeDirecionamento">
            <option value="">--Selecione o setor do chamado--</option>
            <option value="Administracao">Administração</option>
            <option value="Recursos_Humanos">Recursos Humanos</option>
            <option value="Financeiro">Financeiro</option>
            <option value="Vendas">Vendas</option>
            <option value="Marketing">Marketing</option>
            <option value="Producao">Produção</option>
            <option value="TI">Tecnologia da Informação</option>
            <option value="Juridico">Jurídico</option>
            <option value="Logistica">Logística</option>
        </select><br>

        <!-- Adicionando campos ocultos para armazenar as informações do usuário -->
        <input type="hidden" id="usuario" name="usuario" th:value="${param.usuario}">
        <input type="hidden" id="setor" name="setor" th:value="${param.setor}">

        <div th:if="${param.mensagem}">
            <script th:inline="javascript">
                alert([[${param.mensagem}]]);
            </script>
        </div>

        <button type="submit">Criar Chamado</button>
    </form>
</main>

<script>
    // Extrair os parâmetros da URL
    const params = new URLSearchParams(window.location.search);
    const usuario = params.get('usuario');
    const setor = params.get('setor');
    const mensagem = params.get('mensagem'); // Adicionando mensagem

    // Pré-preencher os campos do formulário com as informações do usuário
    document.getElementById('usuario').value = usuario;
    document.getElementById('setor').value = setor;

    // Exibir alerta com a mensagem, se presente
    if (mensagem) {
        alert(mensagem);
    }
</script>

</body>
</html>